{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bless/OneDrive/Desktop/BULK-BUY-ENETRPRISE/frontend/bulk-buy-frontend/app/buyer/rfq/list/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { api } from \"@/lib/api\";\r\nimport Link from \"next/link\";\r\nimport { \r\n  Inbox, \r\n  CheckCircle2, \r\n  Clock, \r\n  ArrowUpRight, \r\n  BarChart3,\r\n  Search,\r\n  Filter,\r\n  Trash2,\r\n  FileText,\r\n  CreditCard,\r\n  MoreHorizontal\r\n} from \"lucide-react\";\r\nimport { toast } from \"sonner\"; // Assuming you use sonner for executive-grade toasts\r\n\r\nexport default function BuyerRFQList() {\r\n  const queryClient = useQueryClient();\r\n\r\n  // 1. DATA FETCHING\r\n  const { data: rfqs, isLoading } = useQuery({\r\n    queryKey: [\"buyer-rfqs\"],\r\n    queryFn: async () => {\r\n      const res = await api.get(\"/rfq/buyer\"); \r\n      return res.data;\r\n    }\r\n  });\r\n\r\n  // 2. DELETE MUTATION (Optimistic UI)\r\n  const deleteMutation = useMutation({\r\n    mutationFn: async (id: string) => {\r\n      await api.delete(`/rfq/${id}`);\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"buyer-rfqs\"] });\r\n      toast.success(\"Requisition purged successfully\");\r\n    },\r\n    onError: () => toast.error(\"System error during deletion protocol\")\r\n  });\r\n\r\n  const handleDelete = (id: string) => {\r\n    if (confirm(\"Are you sure you want to terminate this contract request?\")) {\r\n      deleteMutation.mutate(id);\r\n    }\r\n  };\r\n\r\n  // 3. STATS LOGIC\r\n  const stats = [\r\n    { label: \"Pending Requests\", value: rfqs?.filter((r: any) => r.status === 'PENDING').length || 0, icon: Clock, color: \"text-blue-500\", bg: \"bg-blue-500/10\" },\r\n    { label: \"Accepted Deals\", value: rfqs?.filter((r: any) => r.status === 'ACCEPTED').length || 0, icon: CheckCircle2, color: \"text-emerald-500\", bg: \"bg-emerald-500/10\" },\r\n    { label: \"Total Liability\", value: `$${(rfqs?.reduce((acc: number, r: any) => acc + (r.quantity * (r.vendorCounterPrice || r.targetUnitPrice)), 0) || 0).toLocaleString()}`, icon: BarChart3, color: \"text-indigo-500\", bg: \"bg-indigo-500/10\" }\r\n  ];\r\n\r\n  if (isLoading) return <div className=\"p-20 text-center font-black text-slate-400 animate-pulse tracking-[0.5em]\">SYNCHRONIZING SECURE LEDGER...</div>;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#020617] text-slate-100 p-8 font-sans\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        \r\n        {/* EXECUTIVE HEADER */}\r\n        <header className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-12\">\r\n          <div>\r\n            <h1 className=\"text-4xl font-[1000] tracking-tighter uppercase italic bg-gradient-to-r from-white to-slate-500 bg-clip-text text-transparent\">\r\n              Procurement <span className=\"text-blue-500 text-opacity-80\">Intelligence</span>\r\n            </h1>\r\n            <p className=\"text-slate-500 font-bold text-xs uppercase tracking-[0.2em] mt-2 flex items-center gap-2\">\r\n              <span className=\"w-2 h-2 rounded-full bg-emerald-500 animate-pulse\" />\r\n              Real-time Global Supply Chain Terminal\r\n            </p>\r\n          </div>\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"relative hidden lg:block\">\r\n              <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 text-slate-600\" size={14} />\r\n              <input type=\"text\" placeholder=\"Search Assets...\" className=\"bg-[#0F172A] border border-blue-900/30 rounded-xl pl-10 pr-6 py-3 text-[11px] font-black uppercase tracking-widest focus:border-blue-500 outline-none w-64 transition-all\" />\r\n            </div>\r\n            <button className=\"p-3 bg-[#0F172A] border border-blue-900/30 rounded-xl text-slate-400 hover:text-blue-500 transition-all\"><Filter size={18} /></button>\r\n          </div>\r\n        </header>\r\n\r\n        {/* METRICS GRID */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 mb-12\">\r\n          {stats.map((stat, i) => (\r\n            <div key={i} className=\"bg-[#0F172A] p-8 rounded-[2.5rem] border border-blue-900/20 shadow-2xl relative overflow-hidden group hover:border-blue-500/30 transition-all\">\r\n              <div className={`absolute -right-4 -top-4 w-24 h-24 opacity-5 group-hover:opacity-10 transition-opacity ${stat.color}`}><stat.icon size={96} /></div>\r\n              <div className={`w-12 h-12 ${stat.bg} ${stat.color} rounded-2xl flex items-center justify-center mb-6`}><stat.icon size={24} /></div>\r\n              <p className=\"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1\">{stat.label}</p>\r\n              <p className=\"text-4xl font-[1000] text-white tracking-tighter\">{stat.value}</p>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {/* DATA TABLE */}\r\n        <div className=\"bg-[#0F172A] rounded-[3rem] border border-blue-900/20 shadow-2xl overflow-hidden backdrop-blur-xl\">\r\n          <div className=\"p-8 border-b border-blue-900/10 flex justify-between items-center bg-white/[0.02]\">\r\n            <h2 className=\"text-lg font-black uppercase tracking-tighter italic text-white/90\">Transaction Command Center</h2>\r\n            <div className=\"flex gap-4\">\r\n               <button className=\"text-[10px] font-black text-slate-500 uppercase hover:text-white transition-colors\">Audit Logs</button>\r\n               <button className=\"text-[10px] font-black text-blue-500 uppercase tracking-widest bg-blue-500/10 px-4 py-1.5 rounded-full\">Active Session</button>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"overflow-x-auto\">\r\n            <table className=\"w-full text-left border-collapse\">\r\n              <thead>\r\n                <tr className=\"bg-[#1E293B]/20\">\r\n                  <th className=\"px-8 py-6 text-[9px] font-black text-slate-500 uppercase tracking-[0.3em]\">Asset Class</th>\r\n                  <th className=\"px-8 py-6 text-[9px] font-black text-slate-500 uppercase tracking-[0.3em]\">Contract Value</th>\r\n                  <th className=\"px-8 py-6 text-[9px] font-black text-slate-500 uppercase tracking-[0.3em]\">Status</th>\r\n                  <th className=\"px-8 py-6 text-[9px] font-black text-slate-500 uppercase tracking-[0.3em] text-right\">Operational Action</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"divide-y divide-blue-900/10\">\r\n                {rfqs?.map((rfq: any) => (\r\n                  <tr key={rfq._id} className=\"hover:bg-blue-600/5 transition-all group\">\r\n                    <td className=\"px-8 py-7\">\r\n                      <div className=\"flex items-center gap-5\">\r\n                        <div className=\"w-12 h-12 bg-gradient-to-br from-[#1E293B] to-[#0F172A] rounded-2xl flex items-center justify-center border border-blue-900/30 text-blue-400 group-hover:scale-110 transition-transform\">\r\n                          <BarChart3 size={20} />\r\n                        </div>\r\n                        <div>\r\n                          <p className=\"text-sm font-black text-white tracking-tight leading-none mb-1.5\">{rfq.productId?.name}</p>\r\n                          <div className=\"flex items-center gap-2\">\r\n                             <span className=\"text-[10px] text-slate-500 font-bold uppercase\">Batch: {rfq.quantity.toLocaleString()} units</span>\r\n                             <span className=\"text-slate-700\">|</span>\r\n                             <span className=\"text-[10px] text-blue-500/70 font-bold uppercase\">{rfq.vendorId?.organizationName || \"Awaiting Vendor\"}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    </td>\r\n                    <td className=\"px-8 py-7\">\r\n                      <p className=\"text-sm font-black text-white\">${(rfq.quantity * (rfq.vendorCounterPrice || rfq.targetUnitPrice)).toLocaleString()}</p>\r\n                      <p className=\"text-[9px] text-emerald-500 font-black uppercase tracking-widest mt-1 italic shadow-emerald-500/20\">Authorized Cap</p>\r\n                    </td>\r\n                    <td className=\"px-8 py-7\">\r\n                      <span className={`px-4 py-1.5 rounded-lg text-[9px] font-[1000] uppercase tracking-widest border shadow-inner ${\r\n                        rfq.status === 'ACCEPTED' ? 'bg-emerald-500/10 text-emerald-500 border-emerald-500/30' :\r\n                        rfq.status === 'NEGOTIATING' ? 'bg-amber-500/10 text-amber-500 border-amber-500/30' :\r\n                        rfq.status === 'PAID' ? 'bg-blue-500/10 text-blue-500 border-blue-500/30' :\r\n                        'bg-slate-500/10 text-slate-500 border-white/5'\r\n                      }`}>\r\n                        {rfq.status}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"px-8 py-7\">\r\n                      <div className=\"flex items-center justify-end gap-3\">\r\n                         {/* DYNAMIC ACTION BUTTON */}\r\n                         {rfq.status === 'ACCEPTED' ? (\r\n                            <Link \r\n                              href={`/buyer/invoice/${rfq._id}`}\r\n                              className=\"bg-emerald-600 hover:bg-white hover:text-black text-white px-5 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 shadow-lg shadow-emerald-500/20\"\r\n                            >\r\n                              <CreditCard size={14} /> Settlement\r\n                            </Link>\r\n                         ) : (\r\n                            <Link \r\n                              href={`/buyer/rfq/${rfq._id}`}\r\n                              className=\"bg-blue-600/10 hover:bg-blue-600 text-blue-400 hover:text-white px-5 py-2.5 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all flex items-center gap-2 border border-blue-500/20\"\r\n                            >\r\n                              <FileText size={14} /> Details\r\n                            </Link>\r\n                         )}\r\n\r\n                         {/* DELETE ICON */}\r\n                         <button \r\n                            onClick={() => handleDelete(rfq._id)}\r\n                            className=\"p-2.5 text-slate-600 hover:text-red-500 hover:bg-red-500/10 rounded-xl transition-all\"\r\n                            title=\"Purge Request\"\r\n                         >\r\n                            <Trash2 size={16} />\r\n                         </button>\r\n                      </div>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          \r\n          {(!rfqs || rfqs.length === 0) && (\r\n            <div className=\"p-32 text-center\">\r\n              <div className=\"w-20 h-20 bg-slate-900/50 rounded-full flex items-center justify-center mx-auto mb-6 border border-white/5\">\r\n                <Inbox className=\"text-slate-700\" size={32} />\r\n              </div>\r\n              <p className=\"text-slate-500 font-black uppercase tracking-[0.4em] text-xs\">No active requisition transmissions detected.</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}