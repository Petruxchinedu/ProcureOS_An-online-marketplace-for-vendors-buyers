{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bless/OneDrive/Desktop/BULK-BUY-ENETRPRISE/frontend/bulk-buy-frontend/app/buyer/rfq/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport { api as axios } from \"@/lib/api\";\r\nimport { \r\n  ArrowLeft, Calendar, Package, Clock, \r\n  MessageCircle, Building2, CheckCircle2, AlertCircle, \r\n  FileText, CreditCard, TrendingUp, ChevronRight, ShieldCheck \r\n} from \"lucide-react\";\r\nimport Link from \"next/link\";\r\nimport { toast } from \"react-hot-toast\";\r\n\r\nexport default function RFQDetailsPage() {\r\n  const { id } = useParams();\r\n  const router = useRouter();\r\n  const queryClient = useQueryClient();\r\n\r\n  const { data: rfq, isLoading } = useQuery({\r\n    queryKey: [\"rfq\", id],\r\n    queryFn: async () => {\r\n      const res = await axios.get(`/rfq/${id}`);\r\n      return res.data;\r\n    },\r\n    enabled: !!id,\r\n  });\r\n\r\n  // Mutation to accept counter-offers\r\n  const acceptCounter = useMutation({\r\n    mutationFn: async () => {\r\n      return await axios.patch(`/rfq/${id}/status`, { status: \"ACCEPTED\" });\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"rfq\", id] });\r\n      toast.success(\"Price Agreement Finalized\");\r\n    }\r\n  });\r\n\r\n  if (isLoading) return (\r\n    <div className=\"min-h-screen bg-[#020617] flex flex-col items-center justify-center\">\r\n      <div className=\"w-10 h-10 border-4 border-blue-600/20 border-t-blue-600 rounded-full animate-spin mb-4\" />\r\n      <p className=\"text-[10px] font-black uppercase tracking-[0.3em] text-slate-500\">Syncing Negotiation Ledger...</p>\r\n    </div>\r\n  );\r\n\r\n  const isCountered = rfq?.status === \"NEGOTIATING\" && rfq?.vendorCounterPrice;\r\n  const activePrice = isCountered ? rfq.vendorCounterPrice : rfq?.targetUnitPrice;\r\n  const totalContractValue = activePrice * rfq?.quantity;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-[#F8FAFC] pb-20\">\r\n      {/* GLOBAL STATUS BAR */}\r\n      <nav className=\"bg-white border-b border-slate-200 px-8 py-4 sticky top-0 z-50\">\r\n        <div className=\"max-w-7xl mx-auto flex justify-between items-center\">\r\n          <Link href=\"/buyer/rfq\" className=\"flex items-center text-slate-500 hover:text-blue-600 font-bold text-xs uppercase tracking-widest transition-all\">\r\n            <ArrowLeft className=\"mr-2 h-4 w-4\" /> Back to Procurement Ledger\r\n          </Link>\r\n          <div className=\"flex items-center gap-3\">\r\n             <ShieldCheck size={16} className=\"text-blue-600\" />\r\n             <span className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Escrow Protected</span>\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      <div className=\"max-w-7xl mx-auto py-12 px-8\">\r\n        \r\n        {/* ðŸš€ DYNAMIC CALL TO ACTION SECTION */}\r\n        <div className=\"mb-10\">\r\n          {rfq?.status === 'ACCEPTED' ? (\r\n            <div className=\"bg-slate-900 rounded-[2.5rem] p-10 text-white shadow-2xl flex flex-col md:flex-row items-center justify-between gap-8 relative overflow-hidden\">\r\n              <div className=\"relative z-10 flex items-center gap-6\">\r\n                <div className=\"bg-blue-600 p-5 rounded-3xl shadow-lg shadow-blue-600/20\">\r\n                  <CheckCircle2 size={32} className=\"text-white\" />\r\n                </div>\r\n                <div>\r\n                  <h2 className=\"text-3xl font-[1000] tracking-tighter italic uppercase\">Contract Approved</h2>\r\n                  <p className=\"text-slate-400 font-medium\">Agreement reached at <span className=\"text-white font-black\">${activePrice}/unit</span>. Secure payment required.</p>\r\n                </div>\r\n              </div>\r\n              <Link \r\nhref={`/buyer/rfq/${rfq._id}/pay`} // ðŸš€ UPDATED THIS LINE                className=\"relative z-10 w-full md:w-auto px-10 py-5 bg-blue-600 text-white font-black rounded-2xl hover:bg-blue-700 transition-all flex items-center justify-center gap-3 shadow-xl shadow-blue-600/20 uppercase text-xs tracking-[0.2em]\"\r\n              >\r\n                <CreditCard size={18} /> Initiate Escrow Payment\r\n              </Link>\r\n            </div>\r\n          ) : isCountered ? (\r\n            <div className=\"bg-blue-600 rounded-[2.5rem] p-10 text-white shadow-2xl flex flex-col md:flex-row items-center justify-between gap-8 animate-in fade-in slide-in-from-top-4 duration-700\">\r\n              <div className=\"flex items-center gap-6\">\r\n                <div className=\"bg-white/20 p-5 rounded-3xl backdrop-blur-md\">\r\n                  <TrendingUp size={32} className=\"text-white\" />\r\n                </div>\r\n                <div>\r\n                  <h2 className=\"text-3xl font-[1000] tracking-tighter italic uppercase\">Vendor Counter-Offer</h2>\r\n                  <p className=\"text-blue-100 font-medium\">The vendor proposed a new rate of <span className=\"text-white font-black\">${rfq.vendorCounterPrice}/unit</span>.</p>\r\n                </div>\r\n              </div>\r\n              <button \r\n                onClick={() => acceptCounter.mutate()}\r\n                className=\"w-full md:w-auto px-10 py-5 bg-white text-blue-600 font-black rounded-2xl hover:bg-blue-50 transition-all flex items-center justify-center gap-3 shadow-xl uppercase text-xs tracking-[0.2em]\"\r\n              >\r\n                Accept New Price\r\n              </button>\r\n            </div>\r\n          ) : null}\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-12\">\r\n          \r\n          {/* LEFT: FINANCIAL TERMINAL & TIMELINE */}\r\n          <div className=\"lg:col-span-8 space-y-8\">\r\n            \r\n            {/* FINANCIAL SUMMARY CARD */}\r\n            <div className=\"bg-white rounded-[3rem] border border-slate-200 p-10 shadow-sm overflow-hidden relative\">\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8 mb-10 border-b border-slate-100 pb-10\">\r\n                <div className=\"space-y-2\">\r\n                  <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Requested Volume</p>\r\n                  <p className=\"text-3xl font-[1000] text-slate-900 tracking-tighter\">{rfq?.quantity.toLocaleString()} <span className=\"text-sm font-bold text-slate-400\">PCS</span></p>\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Negotiated Unit</p>\r\n                  <p className=\"text-3xl font-[1000] text-blue-600 tracking-tighter\">${activePrice}</p>\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <p className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest\">Total Contract</p>\r\n                  <p className=\"text-3xl font-[1000] text-emerald-600 tracking-tighter\">${totalContractValue.toLocaleString()}</p>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"space-y-4\">\r\n                <h3 className=\"flex items-center gap-2 text-[10px] font-black text-slate-400 uppercase tracking-widest\">\r\n                  <MessageCircle size={14} className=\"text-blue-500\" /> Procurement Memo\r\n                </h3>\r\n                <div className=\"bg-slate-50 rounded-2xl p-6 border border-slate-100 italic text-slate-600 leading-relaxed\">\r\n                  \"{rfq?.message || \"Standard bulk purchase agreement.\"}\"\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* UPGRADED TIMELINE */}\r\n            <div className=\"bg-white rounded-[3rem] border border-slate-200 p-10 shadow-sm\">\r\n              <h2 className=\"text-xl font-[1000] text-slate-900 mb-8 uppercase tracking-tighter italic\">Audit Trail</h2>\r\n              <div className=\"space-y-8 relative before:absolute before:left-3 before:top-2 before:bottom-2 before:w-0.5 before:bg-slate-100\">\r\n                <div className=\"relative pl-10\">\r\n                  <div className=\"absolute left-0 top-1 w-6 h-6 bg-slate-900 rounded-full flex items-center justify-center border-4 border-white shadow-md\">\r\n                    <CheckCircle2 size={12} className=\"text-white\" />\r\n                  </div>\r\n                  <p className=\"font-black text-slate-900 text-sm\">RFQ Initialized</p>\r\n                  <p className=\"text-[10px] text-slate-400 font-bold uppercase\">{new Date(rfq?.createdAt).toLocaleString()}</p>\r\n                </div>\r\n                \r\n                <div className=\"relative pl-10\">\r\n                  <div className={`absolute left-0 top-1 w-6 h-6 rounded-full flex items-center justify-center border-4 border-white shadow-md ${\r\n                    rfq?.status !== 'PENDING' ? 'bg-blue-600' : 'bg-slate-200'\r\n                  }`}>\r\n                    {rfq?.status !== 'PENDING' ? <CheckCircle2 size={12} className=\"text-white\" /> : <Clock size={12} className=\"text-slate-500\" />}\r\n                  </div>\r\n                  <p className=\"font-black text-slate-900 text-sm\">Vendor Review</p>\r\n                  <p className=\"text-[10px] text-slate-400 font-bold uppercase\">\r\n                    {rfq?.status === 'PENDING' ? 'Awaiting Dispatch...' : `Actioned on ${new Date(rfq?.updatedAt).toLocaleDateString()}`}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* RIGHT SIDEBAR: CONTEXT */}\r\n          <div className=\"lg:col-span-4 space-y-6\">\r\n            <div className=\"bg-white p-8 rounded-[2.5rem] border border-slate-200 shadow-sm overflow-hidden\">\r\n              <h2 className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-6\">Asset Specification</h2>\r\n              <div className=\"flex flex-col items-center text-center\">\r\n                <div className=\"w-full aspect-square bg-slate-50 rounded-3xl flex items-center justify-center overflow-hidden mb-6 border border-slate-100\">\r\n                  {rfq?.productId?.images?.[0] ? (\r\n                    <img src={rfq.productId.images[0]} className=\"w-full h-full object-cover\" />\r\n                  ) : (\r\n                    <Package size={48} className=\"text-slate-200\" />\r\n                  )}\r\n                </div>\r\n                <h3 className=\"font-black text-slate-900 text-lg mb-1\">{rfq?.productId?.name}</h3>\r\n                <p className=\"text-xs font-bold text-blue-600 uppercase tracking-tighter mb-6\">SKU: {rfq?.productId?._id.slice(-8)}</p>\r\n                \r\n                <Link \r\n                  href={`/marketplace/${rfq?.productId?._id}`}\r\n                  className=\"w-full py-4 bg-slate-50 hover:bg-slate-100 rounded-xl text-[10px] font-black uppercase tracking-widest transition-all text-slate-600 border border-slate-200\"\r\n                >\r\n                  View Original Listing\r\n                </Link>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"bg-white p-8 rounded-[2.5rem] border border-slate-200 shadow-sm\">\r\n              <h2 className=\"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-6\">Counterparty</h2>\r\n              <div className=\"flex items-center gap-4 mb-6\">\r\n                <div className=\"w-12 h-12 bg-blue-50 rounded-2xl flex items-center justify-center\">\r\n                  <Building2 size={24} className=\"text-blue-600\" />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm font-black text-slate-900\">{rfq?.vendorId?.name || \"Premium Vendor\"}</p>\r\n                  <div className=\"flex items-center gap-1 text-emerald-500\">\r\n                    <CheckCircle2 size={12} />\r\n                    <span className=\"text-[10px] font-black uppercase tracking-tighter\">Verified Provider</span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"p-4 bg-amber-50 rounded-2xl border border-amber-100\">\r\n                <p className=\"text-[10px] text-amber-700 font-bold leading-relaxed\">\r\n                  Always keep payments within the platform to maintain Escrow Protection and dispute rights.\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}